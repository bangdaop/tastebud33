<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Taste Buds Choices</title>

<style>
body{font-family:Arial;padding:20px}
.field{margin-bottom:12px}
input{width:100%;padding:8px}
#surveyBar{height:6px;background:#ddd}
#surveyBarInner{height:100%;width:0%;background:#6cf}
</style>
</head>

<body>

<h2>Taste Buds Choices</h2>

<div id="surveyBar"><div id="surveyBarInner"></div></div>

<div id="formWrapper"></div>

<script>
const WEBAPP="https://script.google.com/macros/s/AKfycbwXlYjodsqdwXD1lpUObHRUxO-4g99cRvMU77rJ3YMi7ySHMHmiLM-hNceq5RvbCTUw/exec";

let answers={};
let fields=[];

function update(){
 let done=Object.keys(answers).length;
 let pct=Math.round(done/fields.length*100);
 document.getElementById("surveyBarInner").style.width=pct+"%";
}

fetch(WEBAPP)
.then(r=>r.json())
.then(j=>{
 fields=j.config;
 const wrap=document.getElementById("formWrapper");
 fields.forEach(f=>{
   const d=document.createElement("div");
   d.className="field";
   d.innerHTML=`<label>${f.label}</label><br><input>`;
   d.querySelector("input").oninput=e=>{
     answers[f.key]=e.target.value;
     update();
   }
   wrap.append(d);
 });
});
</script>

</body>
</html>
