<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Street Food Survey</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
  <style>
    body{margin:0;font-family:"Roboto",Arial,sans-serif;background:#f4f7fb;padding:28px;display:flex;justify-content:center}
    .container{max-width:820px;background:#fff;border-radius:12px;box-shadow:0 8px 30px rgba(20,30,60,0.08);padding:28px;width:100%}
    .field-row{margin:14px 0;padding:12px;border-radius:10px;background:#fafafa;border:1px solid #eee;display:flex;flex-direction:column;gap:8px}
    .field-row label{font-weight:600;color:#111827;font-size:0.98rem}
    select,input,textarea{padding:10px;border-radius:8px;border:1px solid #ccc;font-size:15px}
    .state-display{margin-top:6px;color:#0f1724;font-weight:600;font-size:0.95rem}
  </style>
</head>
<body>
  <div class="container">
    <h2>Street Food Survey</h2>
    <div id="formContainer"></div>
    <button id="submitBtn">Submit</button>
    <div id="submitMsg"></div>
  </div>

<script>
const WEBAPP_URL = "https://script.google.com/macros/s/AKfycbywZvzhUFXH0EqljIfI-AlwmKwcxeGPzMYUH4eHLSQ1-iFYUV93CPkTFvqwaANl3EoD/exec";

// City -> State & Region mapping
const cityToState = {
  "Ahmedabad":"Gujarat","Bengaluru":"Karnataka","Chennai":"Tamil Nadu","Coimbatore":"Tamil Nadu",
  "Delhi":"Delhi","Guwahati":"Assam","Hyderabad":"Telangana","Indore":"Madhya Pradesh",
  "Jaipur":"Rajasthan","Lucknow":"Uttar Pradesh","Mangaluru":"Karnataka","Mumbai":"Maharashtra",
  "Nagpur":"Maharashtra","Patna":"Bihar","Pune":"Maharashtra","Surat":"Gujarat",
  "Vadodara":"Gujarat","Visakhapatnam":"Andhra Pradesh","Vijayawada":"Andhra Pradesh"
};
const cityToRegion = {
  "Ahmedabad":"West","Bengaluru":"South","Chennai":"South","Coimbatore":"South",
  "Delhi":"North","Guwahati":"Northeast","Hyderabad":"South","Indore":"Central",
  "Jaipur":"North","Lucknow":"North","Mangaluru":"South","Mumbai":"West",
  "Nagpur":"Central","Patna":"East","Pune":"West","Surat":"West",
  "Vadodara":"West","Visakhapatnam":"East","Vijayawada":"East"
};

const cities = Object.keys(cityToState).sort();

function buildForm(){
  const container = document.getElementById("formContainer");
  const wrapper = document.createElement("div");
  wrapper.className = "field-row";

  const label = document.createElement("label");
  label.textContent = "Select your city";
  wrapper.appendChild(label);

  const sel = document.createElement("select");
  const placeholder = document.createElement("option");
  placeholder.value = "";
  placeholder.textContent = "Select your city";
  placeholder.selected = true;
  sel.appendChild(placeholder);

  cities.forEach(c=>{
    const opt=document.createElement("option");
    opt.value=c; opt.textContent=c;
    sel.appendChild(opt);
  });

  const stateDisplay=document.createElement("div");
  stateDisplay.className="state-display";

  sel.onchange=()=>{
    const chosenCity=sel.value;
    const state=cityToState[chosenCity]||"";
    const region=cityToRegion[chosenCity]||"";
    stateDisplay.textContent= state ? "State: "+state : "";
    // remove placeholder after first selection
    if(sel.querySelector('option[value=""]')){
      sel.removeChild(sel.querySelector('option[value=""]'));
    }
    // send to server
    fetch(WEBAPP_URL,{
      method:"POST",
      body:JSON.stringify({sessionId:"demo",fieldName:"city",fieldValue:chosenCity,state,region})
    });
  };

  wrapper.appendChild(sel);
  wrapper.appendChild(stateDisplay);
  container.appendChild(wrapper);
}

buildForm();
</script>
</body>
</html>
