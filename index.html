<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Taste Buds Choices</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        #progressLabel,
        #surveyText {
            display: none !important;
        }

        .field input,
        .field textarea,
        .field select {
            width: 100% !important;
        }

        :root {
            --bg1: #f6f8fa;
            --bg2: #eef2f5;
            --card: #ffffff;
            --accent: #ff7a00;
            --accent-2: #0d3b66;
            --muted: #6b7280;
            --radius: 12px;
            --shadow: 0 14px 40px rgba(13, 59, 102, 0.08);
            --gap: 14px;
        }

        html,
        body {
            height: 100%;
            margin: 0;
            font-family: "Poppins", system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial;
            color: #111827;
            background: linear-gradient(180deg, var(--bg1), var(--bg2));
            -webkit-font-smoothing: antialiased
        }

        .app {
            max-width: 980px;
            margin: 20px auto;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: var(--shadow);
            background: linear-gradient(180deg, #fff, #fbfbff);
            border: 1px solid rgba(13, 59, 102, 0.04)
        }

        header {
            position: relative;
            padding: 22px 20px 28px;
            text-align: center;
            color: #fff;
            background-color: rgba(13, 59, 102, 0.06);
            overflow: visible;
            min-height: 120px
        }

        header .bg-img {
            position: absolute;
            inset: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            z-index: 0;
            opacity: 0.98
        }

        header .overlay {
            position: absolute;
            inset: 0;
            background: linear-gradient(180deg, rgba(13, 59, 102, 0.18), rgba(13, 59, 102, 0.12));
            z-index: 1
        }

        header .content {
            position: relative;
            z-index: 2
        }

        h1 {
            position: relative;
            display: inline-block;
            margin: 0;
            font-size: 30px;
            color: #ffea00;
            font-weight: 800;
            padding: 6px 14px;
            border-radius: 10px;
            text-shadow: 0 0 8px #ff2828, 0 0 16px #ff2828, 0 0 24px #ff4444, 0 0 32px #ff2828, 0 0 40px rgba(255, 68, 68, .6), 0 0 60px rgba(255, 40, 40, .4), 0 4px 16px rgba(0, 0, 0, .3)
        }

        .tagline {
            position: relative;
            display: inline-block;
            margin-top: 8px;
            color: #ffea66;
            font-size: 20px;
            line-height: 1.3;
            font-weight: 600;
            padding: 4px 10px;
            border-radius: 8px;
            text-shadow: 0 0 6px #ff2828, 0 0 12px #ff2828, 0 0 18px #ff4444, 0 0 24px rgba(255, 40, 40, .5), 0 0 32px rgba(255, 68, 68, .4)
        }

        main {
            display: flex;
            gap: var(--gap);
            padding: 16px
        }

        .left {
            flex: 1;
            min-width: 0
        }

        .card {
            background: var(--card);
            border-radius: 12px;
            padding: 12px;
            border: 1px solid rgba(13, 59, 102, 0.03)
        }

        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px
        }

        .field {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: 6px;
            padding: 6px;
            border-radius: 10px
        }

        label {
            font-weight: 600;
            color: #0f172a;
            font-size: 13px
        }

        .control-bg {
            background: linear-gradient(180deg, rgba(238, 242, 245, 0.9), rgba(246, 248, 250, 0.95));
            border-radius: 10px;
            padding: 6px
        }

        select,
        input,
        textarea {
            font-size: 15px;
            padding: 12px;
            border-radius: 10px;
            border: 1px solid rgba(13, 59, 102, 0.06);
            background: transparent;
            color: #0f172a;
            width: 100%;
            box-sizing: border-box
        }

        .hint {
            font-size: 12px;
            color: var(--muted);
            margin-top: 6px
        }

        .age-panel {
            margin-top: 8px;
            padding: 10px;
            border-radius: 10px;
            background: linear-gradient(180deg, #fff, #fcfcff);
            border: 1px solid rgba(13, 59, 102, 0.03)
        }

        .age-tagline {
            font-weight: 700;
            color: var(--accent-2);
            font-size: 14px
        }

        .summary-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px;
            border-radius: 8px;
            background: linear-gradient(180deg, #fff, #fbfbff);
            border: 1px solid rgba(13, 59, 102, 0.03);
            font-size: 13px
        }

        .controls {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
            margin-top: 14px
        }

        .btn-primary {
            background: linear-gradient(180deg, var(--accent), #d95b00);
            color: white;
            border: none;
            padding: 12px 18px;
            border-radius: 12px;
            font-weight: 700;
            cursor: pointer
        }

        .btn-secondary {
            background: transparent;
            border: 1px solid #e6eef6;
            padding: 10px 14px;
            border-radius: 10px;
            cursor: pointer
        }

        .small-muted {
            font-size: 13px;
            color: var(--muted)
        }

        .sidebar {
            width: 320px;
            display: flex;
            flex-direction: column;
            gap: 12px
        }

        @media (max-width:820px) {
            main {
                flex-direction: column;
                padding: 12px
            }

            .form-grid {
                grid-template-columns: 1fr
            }

            .sidebar {
                display: none
            }

            .controls {
                display: flex
            }

            .app {
                margin: 8px
            }

            header {
                padding: 18px
            }
        }

        #progressWrap {
            position: relative;
            height: 6px;
            background: transparent;
            border-radius: 6px;
            overflow: hidden;
            margin: 8px 0 6px
        }

        #progressBar {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, #cfe9ff, #9fd6ff);
            box-shadow: 0 6px 18px rgba(31, 120, 255, 0.08);
            transition: width 300ms ease
        }

        #progressLabel {
            font-size: 12px;
            color: var(--muted);
            margin-top: 6px;
            text-align: center
        }

        #surveyWrap {
            margin-top: 8px
        }

        #surveyBar {
            height: 6px;
            background: #e6f2ff;
            border-radius: 6px;
            overflow: hidden
        }

        #surveyBarInner {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, #cfe9ff, #9fd6ff);
            transition: width 300ms ease
        }

        #surveyText {
            font-size: 12px;
            color: var(--muted);
            margin-top: 4px;
            text-align: center
        }
    </style>
</head>

<body>
    <div class="app" role="application" aria-labelledby="appTitle">
        <header>
            <img class="bg-img" id="headerBg" alt="header background"
                src="https://raw.githubusercontent.com/bangdaop/33cimg/refs/heads/main/photo_6062312442882100596_y.jpg"
                onerror="this.style.display='none';document.querySelector('header').style.background='linear-gradient(180deg,#0d3b66,#1f6fbf)';" />
            <div class="overlay"></div>
            <div class="content">
                <h1 id="appTitle">Taste Buds Choices</h1>
                <div class="tagline">Pick your combo — we’ll drop it near you. Lock your picks and we’ll deliver vibes.
                </div>
            </div>
        </header>
        <main>
            <div class="left">
                <div id="formArea" class="card" aria-live="polite">
                    <div id="progressWrap">
                        <div id="progressBar"></div>
                    </div>
                    <div id="progressLabel">Loading form…</div>
                    <div id="surveyWrap" style="display:none">
                        <div id="surveyBar">
                            <div id="surveyBarInner"></div>
                        </div>
                        <div id="surveyText"></div>
                    </div>
                    <div id="formWrapper" style="margin-top:12px;"></div>
                </div>
                <div class="controls" style="margin-top:12px">
                    <button id="resetBtn" class="btn-secondary" type="button">Reset</button>
                    <button id="submitBtn" class="btn-primary" type="button">Finish</button>
                </div>
                <div id="message" style="margin-top:12px"></div>
            </div>
            <aside class="sidebar">
                <div class="card">
                    <div style="font-weight:700;margin-bottom:6px">Your quick summary</div>
                    <div id="summaryList" style="display:flex;flex-direction:column;gap:8px"></div>
                    <div class="small-muted" style="font-size:12px;margin-top:8px">Autosaves as you interact.</div>
                </div>
            </aside>
        </main>
    </div>
   <script>
const WEBAPP_URL="https://script.google.com/macros/s/AKfycbwXlYjodsqdwXD1lpUObHRUxO-4g99cRvMU77rJ3YMi7ySHMHmiLM-hNceq5RvbCTUw/exec";

let sessionId=localStorage.getItem("tb_session_id");
if(!sessionId){
 sessionId='s_'+Math.random().toString(36).slice(2,12);
 localStorage.setItem("tb_session_id",sessionId);
}

const answers={};
let configFields=[];

function el(t,a={},...c){
 const n=document.createElement(t);
 for(const k in a){k==="class"?n.className=a[k]:n.setAttribute(k,a[k]);}
 c.forEach(x=>n.append(x));
 return n;
}

function qs(s){return document.querySelector(s);}
function qsa(s){return [...document.querySelectorAll(s)];}

function updateSurveyProgress(){
 if(!configFields.length)return;
 let done=0;
 configFields.forEach(f=>{
   const v=answers[f.key];
   if(Array.isArray(v)?v.length:v)done++;
 });
 const pct=Math.round(done/configFields.length*100);
 qs("#surveyWrap").style.display="block";
 qs("#surveyBarInner").style.width=pct+"%";
}

function updateSummary(){
 const s=qs("#summaryList");
 s.innerHTML="";
 Object.keys(answers).forEach(k=>{
   s.append(el("div",{class:"summary-row"},el("div",{},k),el("div",{},answers[k])));
 });
 updateSurveyProgress();
}

function buildForm(cfg){
 configFields=cfg;
 const w=qs("#formWrapper");
 w.innerHTML="";
 const g=el("div",{class:"form-grid"});
 cfg.forEach(f=>{
   const fld=el("div",{class:"field"},el("label",{},f.label));
   let i;
   if(f.type==="number") i=el("input",{type:"number"});
   else i=el("input",{type:"text"});
   i.onchange=()=>{answers[f.key]=i.value;updateSummary();}
   fld.append(el("div",{class:"control-bg"},i));
   g.append(fld);
 });
 w.append(g);
}

fetch(WEBAPP_URL).then(r=>r.json()).then(j=>{
 if(j.config)buildForm(j.config);
});
</script>

</body>

</html>
